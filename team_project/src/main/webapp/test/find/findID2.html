<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDì°¾ê¸° ê²°ê³¼</title>
<style>
        /* í°íŠ¸ ë“±ë¡ */
        @font-face {
            font-family: 'PixelFont'; 
            src: url('../DungGeunMo.ttf') format('truetype'); 
            font-weight: normal;
            font-style: normal;
        }

        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ë° ë°°ê²½ */
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('../bgimg/í•˜ëŠ˜ë°°ê²½.png'); 
            background-size: cover;
            background-position: center;
            font-family: Arial, sans-serif;
            overflow: hidden;
            background-repeat: no-repeat;
            background-size: 60% auto;
            background-color: #87CEEB;
        }

        .container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%); 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'PixelFont', monospace;
        }


        .register-window {
            width: 600px;
            height: 350px; 
            background-color: rgba(0, 0, 0, 0.8);
            border: 4px solid #3a3a3a;
            display: flex;
            flex-direction: column;
            color: #3a3a3a;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
            padding: 20px;
            box-sizing: border-box;
        }

        /* íƒ€ì´í‹€ ë°” */
        .title-bar {
            background-color: #3a3a3a;
            color: white;
            font-size: 24px;
            padding: 10px 0;
            text-align: center;
            margin-bottom: 5px;
            border-bottom: 2px solid #5a5a5a;
            text-shadow: 2px 2px 0 #000;
        }

        /* ì…ë ¥ í•„ë“œ ë° ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
        .content-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 30px; 
        }

        /* ë¬¸ì¥ë§Œ í‘œì‹œí•˜ëŠ” ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .input-field-container {
            display: flex;
            align-items: center;
            margin: 15px 0 20px; 
            width: 100%; 
            justify-content: center; 
            max-width: none;
        }
        
        /* ID ì¶œë ¥ ì˜ì—­ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        #idDisplay {
            font-size: 32px; 
            color: #ffe082; 
            margin: 10px 0 40px; 
            text-shadow: 2px 2px 0 #8b4513;
            /* ì´ˆê¸°ì—ëŠ” ë³´ì´ì§€ ì•Šê²Œ */
            visibility: hidden; 
        }

        #resultMessage {
            font-size: 20px; 
            color: white;
            width: auto; 
            flex-shrink: 0;
            text-align: center; 
            cursor: default; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ëª¨ì–‘ ë³€ê²½ ì œê±° */
        }
        
        /* HOME ë²„íŠ¼ */
        .next-button {
            width: 150px; 
            height: 50px; 
            margin: 0; 
            background-color: #d89617;
            color: white;
			font-family: 'PixelFont', monospace; 
            font-size: 24px; 
            border: 4px solid #8b4513;
            cursor: pointer;
            text-shadow: 2px 2px 0 #8b4513;
            box-shadow: 
                -4px -4px 0 #ffe082 inset, 
                 4px  4px 0 #8b4513 inset;
            line-height: 42px; 
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.1s;
        }

        .next-button:hover {
            background-color: #e0ac42;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const nextButton = document.querySelector('.next-button');
            const resultMessageDiv = document.getElementById('resultMessage');
            const idDisplayDiv = document.getElementById('idDisplay');
            
            // 1. ì´ˆê¸° ë©”ì‹œì§€ ì„¤ì •
            resultMessageDiv.textContent = "ğŸ” IDë¥¼ ì¡°íšŒ ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...";
            idDisplayDiv.textContent = "";

            // 2. í˜ì´ì§€ ë¡œë“œ í›„ ì„œë²„ì— ID ìš”ì²­ (AJAX) - ì˜¤ë¥˜ ì„¸ë¶„í™” ë¡œì§ ìœ ì§€
            // â­ï¸ ê²½ë¡œ í™•ì¸: /team_project/getFoundId â­ï¸
            fetch('/team_project/getFoundId', { 
                method: 'GET'
            })
            .then(response => {
                // â­ï¸ 1ë‹¨ê³„: HTTP ìƒíƒœ ì½”ë“œë¥¼ ë¨¼ì € ê²€ì‚¬í•˜ì—¬ ë°°í¬/ì„¸ì…˜ ì˜¤ë¥˜ë¥¼ ì‹ë³„ â­ï¸
                if (response.ok) {
                    // 200 OKì¼ ê²½ìš°, ì„œë²„ í…ìŠ¤íŠ¸ ì‘ë‹µ ë¶„ì„ìœ¼ë¡œ ë„˜ì–´ê°
                    return response.text();
                } else if (response.status === 404) {
                    // 404 Not Found (ì„œë¸”ë¦¿ ë§¤í•‘ ì˜¤ë¥˜)
                    // ì´ ì˜¤ë¥˜ê°€ ëœ¬ë‹¤ë©´ ì„œë²„ ì¬ì‹œì‘ì„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.
                    throw new Error("ğŸš¨404_NOT_FOUND: ì„œë²„ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë¸”ë¦¿ ë§¤í•‘ê³¼ ì„œë²„ ì¬ì‹œì‘ì„ í™•ì¸í•˜ì„¸ìš”.");
                } else if (response.status === 401) {
                    // 401 Unauthorized (GetFoundIdServletì—ì„œ ì„¸ì…˜ì´ nullì¼ ë•Œ ë°˜í™˜)
                    return response.text().then(text => {
                         throw new Error(`âš ï¸${response.status}_AUTH_ERROR: ${text.substring(6).split(":")[0] || "ì„¸ì…˜ ì¸ì¦ ì‹¤íŒ¨"}`);
                    });
                } else {
                    // ê¸°íƒ€ ì„œë²„ ì—ëŸ¬ (500 Internal Server Error ë“±)
                    throw new Error(`ğŸš«HTTP_ERROR_${response.status}: ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (500 ì˜¤ë¥˜ë¼ë©´ ì„œë²„ ë¡œê·¸ í™•ì¸)`);
                }
            })
            .then(text => {
                // â­ï¸ 2ë‹¨ê³„: ì„œë²„ í…ìŠ¤íŠ¸ ì‘ë‹µ ë¶„ì„ (text.startsWith("success:")) â­ï¸
                if (text.startsWith("success:")) {
                    const foundId = text.substring(8); // "success:" ì´í›„ì˜ ID ê°’
                    resultMessageDiv.textContent = "ê³ ê°ë‹˜ì˜ IDëŠ” ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.";
                    idDisplayDiv.textContent = foundId;
                    idDisplayDiv.style.visibility = 'visible'; // ID í‘œì‹œ
                } else if (text.startsWith("error:")) {
                    // ì„œë²„ê°€ 200 OKë¥¼ ë³´ëƒˆì§€ë§Œ, í…ìŠ¤íŠ¸ëŠ” error:ë¡œ ì‹œì‘í•  ê²½ìš° (ì˜ˆì™¸ì ì¸ ê²½ìš°)
                    const errorCode = text.substring(6).split(":")[0];
                    throw new Error(`âŒSERVER_LOGIC_ERROR: ${errorCode} (ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜)`);
                } else {
                    throw new Error("â“UNKNOWN_RESPONSE: ì„œë²„ ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                }
            })
            .catch(error => {
                console.error('Fetch error:', error);
                // ëª¨ë“  ì˜¤ë¥˜ëŠ” ì—¬ê¸°ì„œ ì¡íˆë©°, ì„¸ë¶„í™”ëœ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
                resultMessageDiv.textContent = error.message;
                idDisplayDiv.style.visibility = 'hidden';
            });


            // 3. HOME ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘ (ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™)
            nextButton.addEventListener('click', function() {
                // ğŸš¨ ì´ íŒŒì¼ëª…ì„ ì‹¤ì œ ë‹¤ìŒ í˜ì´ì§€ íŒŒì¼ëª…ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”
                window.location.href = '../main/main_page.html'; 
            });
        });
    </script>
</head>

<body>
    <div class="container">
        <div class="register-window">
            <div class="title-bar">ID ì°¾ê¸° ê²°ê³¼</div>

            <div class="content-area">
                <div class="input-field-container">
                    <label id="resultMessage"></label>
                </div>
                
                <div id="idDisplay"></div>
                
                <button class="next-button">HOME</button>
            </div>
        </div>
    </div>
</body>
</html>
